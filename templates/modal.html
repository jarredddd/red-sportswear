<div id="crudModal" class="hidden fixed inset-0 z-50 w-full flex items-center justify-center bg-gradient-to-br from-gray-900/80 via-gray-800/80 to-black/80 backdrop-blur-sm transition-all duration-300">
  <div id="crudModalContent" class="bg-white rounded-2xl shadow-2xl w-11/12 sm:w-4/5 md:w-3/5 lg:w-1/2 xl:w-2/5 max-h-[90vh] overflow-hidden transform transition-all duration-300 opacity-0 scale-95">
    
    <!-- Modal Header with Gradient -->
    <div class="relative bg-gradient-to-r from-[#960808] to-[#730808] p-6 rounded-t-2xl">
      <div class="absolute inset-0 bg-black/10"></div>
      <div class="relative flex items-center justify-between">
        <div class="flex items-center space-x-4">
          <div class="bg-white/20 backdrop-blur-sm p-3 rounded-xl">
            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"/>
            </svg>
          </div>
          <div>
            <h3 class="text-2xl font-bold text-white">
              Create New Product
            </h3>
            <p class="text-white/80 text-sm mt-1">Share your products with the community</p>
          </div>
        </div>
        <button type="button" class="text-white/80 hover:text-white bg-white/10 hover:bg-white/20 rounded-xl text-sm p-2.5 transition-all duration-200 backdrop-blur-sm" onclick="hideModal()">
          <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/>
          </svg>
        </button>
      </div>
    </div>

    <!-- Modal Body with Modern Form -->
    <div class="px-6 py-6 space-y-6 max-h-[calc(90vh-200px)] overflow-y-auto">
      <form id="productForm" class="space-y-5">
        
        <!-- Product Name -->
        <div class="group">
          <label for="name" class="block text-sm font-semibold text-gray-700 mb-2 flex items-center">
            <svg class="w-4 h-4 mr-2 text-[#960808]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"/>
            </svg>
            Product Name
          </label>
          <input type="text" id="name" name="name" 
            class="w-full border-2 border-gray-200 rounded-xl px-4 py-3 focus:border-[#960808] focus:ring-2 focus:ring-[#960808]/20 transition-all duration-200 outline-none"
            placeholder="Enter product name" required>
        </div>

        <!-- Description -->
        <div class="group">
          <label for="description" class="block text-sm font-semibold text-gray-700 mb-2 flex items-center">
            <svg class="w-4 h-4 mr-2 text-[#960808]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h7"/>
            </svg>
            Description
          </label>
          <textarea id="description" name="description" rows="3"
            class="w-full border-2 border-gray-200 rounded-xl px-4 py-3 focus:border-[#960808] focus:ring-2 focus:ring-[#960808]/20 transition-all duration-200 outline-none resize-none"
            placeholder="Describe your product..." required></textarea>
        </div>

        <!-- Price and Stock Row -->
        <div class="grid grid-cols-2 gap-4">
          <div class="group">
            <label for="price" class="block text-sm font-semibold text-gray-700 mb-2 flex items-center">
              <svg class="w-4 h-4 mr-2 text-[#960808]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
              </svg>
              Price
            </label>
            <input type="number" id="price" name="price"
              class="w-full border-2 border-gray-200 rounded-xl px-4 py-3 focus:border-[#960808] focus:ring-2 focus:ring-[#960808]/20 transition-all duration-200 outline-none"
              placeholder="0" required min="0">
          </div>

          <div class="group">
            <label for="stok" class="block text-sm font-semibold text-gray-700 mb-2 flex items-center">
              <svg class="w-4 h-4 mr-2 text-[#960808]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"/>
              </svg>
              Stock
            </label>
            <input type="number" id="stok" name="stok"
              class="w-full border-2 border-gray-200 rounded-xl px-4 py-3 focus:border-[#960808] focus:ring-2 focus:ring-[#960808]/20 transition-all duration-200 outline-none"
              placeholder="0" required min="0">
          </div>
        </div>

        <!-- Category -->
        <div class="group">
          <label for="category" class="block text-sm font-semibold text-gray-700 mb-2 flex items-center">
            <svg class="w-4 h-4 mr-2 text-[#960808]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"/>
            </svg>
            Category
          </label>
          <select id="category" name="category"
            class="w-full border-2 border-gray-200 rounded-xl px-4 py-3 focus:border-[#960808] focus:ring-2 focus:ring-[#960808]/20 transition-all duration-200 outline-none bg-white cursor-pointer"
            required>
            <option value="" class="text-gray-400">Choose a category</option>
            <option value="sepatu running">Sepatu Running</option>
            <option value="sepatu futsal">Sepatu Futsal</option>
            <option value="sepatu bola">Sepatu Bola</option>
            <option value="jersey">Jersey</option>
            <option value="topi">Topi</option>
            <option value="celana training">Celana Training</option>
          </select>
        </div>

        <!-- Thumbnail URL -->
        <div class="group">
          <label for="thumbnail" class="block text-sm font-semibold text-gray-700 mb-2 flex items-center">
            <svg class="w-4 h-4 mr-2 text-[#960808]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/>
            </svg>
            Thumbnail URL
          </label>
          <input type="url" id="thumbnail" name="thumbnail"
            class="w-full border-2 border-gray-200 rounded-xl px-4 py-3 focus:border-[#960808] focus:ring-2 focus:ring-[#960808]/20 transition-all duration-200 outline-none"
            placeholder="https://example.com/image.jpg">
          <p class="text-xs text-gray-500 mt-1">Optional: Add an image URL for your product</p>
        </div>

        <!-- Featured Product Toggle -->
        <div class="bg-gradient-to-r from-amber-50 to-yellow-50 border-2 border-amber-200 rounded-xl p-4">
          <div class="flex items-center justify-between">
            <div class="flex items-center space-x-3">
              <div class="bg-amber-500 p-2 rounded-lg">
                <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                  <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
                </svg>
              </div>
              <div>
                <label for="is_featured" class="text-sm font-semibold text-gray-900">Featured Product</label>
                <p class="text-xs text-gray-600">Highlight this product on the homepage</p>
              </div>
            </div>
            <label class="relative inline-flex items-center cursor-pointer">
              <input id="is_featured" name="is_featured" type="checkbox" class="sr-only peer">
              <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-amber-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-amber-500"></div>
            </label>
          </div>
        </div>

      </form>
    </div>

    <!-- Modal Footer with Modern Buttons -->
    <div class="bg-gray-50 px-6 py-4 rounded-b-2xl border-t border-gray-200">
      <div class="flex flex-col sm:flex-row gap-3">
        <button type="button" id="cancelButton"
          class="order-2 sm:order-1 px-6 py-3 border-2 border-gray-300 text-gray-700 rounded-xl font-semibold hover:bg-gray-100 hover:border-gray-400 transition-all duration-200"
          onclick="hideModal()">
          Cancel
        </button>
        <button type="submit" id="submitNews" form="productForm"
          class="order-1 sm:order-2 flex-1 bg-gradient-to-r from-[#960808] to-[#730808] text-white px-6 py-3 rounded-xl font-semibold hover:shadow-lg hover:scale-105 transition-all duration-200 flex items-center justify-center space-x-2">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"/>
          </svg>
          <span>Publish Product</span>
        </button>
      </div>
    </div>

  </div>
</div>

<script>
  function showModal() {
      const modal = document.getElementById('crudModal');
      const modalContent = document.getElementById('crudModalContent');

      modal.classList.remove('hidden'); 
      setTimeout(() => {
        modalContent.classList.remove('opacity-0', 'scale-95');
        modalContent.classList.add('opacity-100', 'scale-100');
      }, 50); 
  }

  function hideModal() {
      const modal = document.getElementById('crudModal');
      const modalContent = document.getElementById('crudModalContent');

      modalContent.classList.remove('opacity-100', 'scale-100');
      modalContent.classList.add('opacity-0', 'scale-95');

      setTimeout(() => {
        modal.classList.add('hidden');
      }, 150); 
  }

  async function addNewsEntry() {
    await fetch("{% url 'main:add_news_entry_ajax' %}", {
      method: "POST",
      body: new FormData(document.querySelector('#productForm')),
    })

    document.getElementById("productForm").reset();
    hideModal();
      
    // Show toast notification
    showToast('Success!', 'Product added successfully!');

    // Dispatch custom event to notify main.html about new data
    document.dispatchEvent(new CustomEvent('newsAdded'));

    return false;
  }

  document.getElementById("productForm").addEventListener("submit", function(e) {
    e.preventDefault();
    addNewsEntry();
  })
</script>